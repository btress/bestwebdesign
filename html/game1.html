<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ Ch∆°i B·∫£o V·ªá ƒê·ªông V·∫≠t</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #e8f5e9;
            margin: 0;
            padding: 20px;
            color: #2e7d32;
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            color: #2e7d32;
            margin-bottom: 10px;
        }
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 400px;
            margin-bottom: 20px;
        }
        .score, .moves, .target {
            background-color: #a5d6a7;
            padding: 10px;
            border-radius: 10px;
            width: 120px;
            text-align: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            gap: 2px;
            background-color: #81c784;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .cell {
            width: 50px;
            height: 50px;
            background-color: #c8e6c9;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            transition: transform 0.2s;
        }
        .cell:hover {
            transform: scale(1.05);
        }
        .cell.selected {
            border: 3px solid #ffeb3b;
            box-sizing: border-box;
        }
        .cell.highlighted {
            background-color: #ffccbc;
        }
        .animal {
            font-size: 30px;
            user-select: none;
        }
        button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin-top: 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #388e3c;
        }
        .message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            background-color: #c8e6c9;
            display: none;
            text-align: center;
        }
        .level-complete {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .level-complete-content {
            background-color: #e8f5e9;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
        }
        .facts {
            margin-top: 20px;
            padding: 15px;
            background-color: #c8e6c9;
            border-radius: 10px;
            max-width: 400px;
            text-align: center;
        }
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ffeb3b;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 10;
        }
    </style>
</head>
<body>
    <header>
        <h1>Tr√≤ Ch∆°i Gh√©p ƒê·ªông V·∫≠t</h1>
        <p>Gh√©p 3 ho·∫∑c nhi·ªÅu ƒë·ªông v·∫≠t c√πng lo·∫°i ƒë·ªÉ b·∫£o v·ªá ch√∫ng kh·ªèi nguy hi·ªÉm!</p>
    </header>

    <div class="game-info">
        <div class="score">ƒêi·ªÉm: <span id="score">0</span></div>
        <div class="moves">L∆∞·ª£t: <span id="moves">20</span></div>
        <div class="target">M·ª•c ti√™u: <span id="target">500</span></div>
    </div>

    <div class="game-board" id="game-board"></div>

    <button id="restart-button">Ch∆°i L·∫°i</button>
    <div id="message" class="message"></div>

    <div class="facts">
        <h3>Th√¥ng tin b·∫£o v·ªá ƒë·ªông v·∫≠t</h3>
        <p id="animal-fact">M·ªói nƒÉm c√≥ h√†ng ngh√¨n lo√†i ƒë·ªông v·∫≠t ƒëang ƒë·ªëi m·∫∑t v·ªõi nguy c∆° tuy·ªát ch·ªßng. H√£y ch∆°i ƒë·ªÉ t√¨m hi·ªÉu th√™m v·ªÅ ch√∫ng!</p>
    </div>

    <div class="level-complete" id="level-complete">
        <div class="level-complete-content">
            <h2>Xu·∫•t s·∫Øc!</h2>
            <p>B·∫°n ƒë√£ ho√†n th√†nh c·∫•p ƒë·ªô v√† c·ª©u ƒë∆∞·ª£c nhi·ªÅu ƒë·ªông v·∫≠t!</p>
            <p>ƒêi·ªÉm s·ªë c·ªßa b·∫°n: <span id="final-score">0</span></p>
            <button id="next-level">C·∫•p ƒë·ªô ti·∫øp theo</button>
        </div>
    </div>

    <div id="popup" class="popup"></div>

    <script>
        // C√°c bi·∫øn to√†n c·ª•c
        const boardSize = 8;
        const animals = ['üê∂', 'üê±', 'üêº', 'üê∞', 'üê¢', 'ü¶ä'];
        let board = [];
        let selectedCell = null;
        let score = 0;
        let moves = 20;
        let target = 500;
        let level = 1;
        let isSwapping = false;

        // Th√¥ng tin b·∫£o v·ªá ƒë·ªông v·∫≠t
        const animalFacts = [
            "C√≥ h∆°n 1000 lo√†i ƒë·ªông v·∫≠t tr√™n th·∫ø gi·ªõi ƒëang b·ªã ƒëe d·ªça tuy·ªát ch·ªßng.",
            "N·∫°n sƒÉn b·∫Øt tr√°i ph√©p l√† m·ªôt trong nh·ªØng nguy√™n nh√¢n ch√≠nh d·∫´n ƒë·∫øn tuy·ªát ch·ªßng.",
            "G·∫•u tr√∫c t·ª´ng ƒë·ªëi m·∫∑t v·ªõi nguy c∆° tuy·ªát ch·ªßng nh∆∞ng ƒë√£ ph·ª•c h·ªìi nh·ªù n·ªó l·ª±c b·∫£o t·ªìn.",
            "R√πa bi·ªÉn ƒëang g·∫∑p nguy hi·ªÉm do r√°c th·∫£i nh·ª±a v√† bi·∫øn ƒë·ªïi kh√≠ h·∫≠u.",
            "H·ªï l√† m·ªôt trong nh·ªØng lo√†i m√®o l·ªõn ƒëang b·ªã ƒëe d·ªça nghi√™m tr·ªçng.",
            "Nhi·ªÅu lo√†i ƒë·ªông v·∫≠t m·∫•t m√¥i tr∆∞·ªùng s·ªëng do n·∫°n ph√° r·ª´ng.",
            "N·∫°n bu√¥n b√°n ƒë·ªông v·∫≠t hoang d√£ l√† ng√†nh t·ªôi ph·∫°m l·ªõn th·ª© 4 tr√™n th·∫ø gi·ªõi.",
            "√î nhi·ªÖm ƒë·∫°i d∆∞∆°ng ƒëe d·ªça h∆°n 700 lo√†i sinh v·∫≠t bi·ªÉn.",
            "M·ªói nƒÉm, 8 tri·ªáu t·∫•n r√°c th·∫£i nh·ª±a ƒë·ªï ra ƒë·∫°i d∆∞∆°ng, ·∫£nh h∆∞·ªüng ƒë·∫øn ƒë·ªông v·∫≠t bi·ªÉn.",
            "B·∫°n c√≥ th·ªÉ gi√∫p b·∫£o v·ªá ƒë·ªông v·∫≠t b·∫±ng c√°ch gi·∫£m s·ª≠ d·ª•ng nh·ª±a v√† tham gia c√°c t·ªï ch·ª©c b·∫£o t·ªìn."
        ];

        // Kh·ªüi t·∫°o tr√≤ ch∆°i
        function initGame() {
            createBoard();
            updateScore();
            updateMoves();
            updateTarget();
            updateAnimalFact();
            
            // Th√™m s·ª± ki·ªán cho n√∫t ch∆°i l·∫°i
            document.getElementById('restart-button').addEventListener('click', restartGame);
            
            // Th√™m s·ª± ki·ªán cho n√∫t c·∫•p ƒë·ªô ti·∫øp theo
            document.getElementById('next-level').addEventListener('click', nextLevel);
        }

        // T·∫°o b·∫£ng tr√≤ ch∆°i
        function createBoard() {
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '';
            board = [];

            for (let row = 0; row < boardSize; row++) {
                board[row] = [];
                for (let col = 0; col < boardSize; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    let animal;
                    do {
                        animal = animals[Math.floor(Math.random() * animals.length)];
                    } while (
                        // Tr√°nh t·∫°o ra c√°c tr·∫≠n ƒë·∫•u s·∫µn c√≥
                        (col >= 2 && board[row][col-1] === animal && board[row][col-2] === animal) ||
                        (row >= 2 && board[row-1][col] === animal && board[row-2][col] === animal)
                    );
                    
                    board[row][col] = animal;
                    
                    const animalSpan = document.createElement('span');
                    animalSpan.className = 'animal';
                    animalSpan.textContent = animal;
                    
                    cell.appendChild(animalSpan);
                    cell.addEventListener('click', () => cellClick(row, col));
                    
                    gameBoard.appendChild(cell);
                }
            }
            
            // Ki·ªÉm tra xem c√≥ n∆∞·ªõc ƒëi h·ª£p l·ªá kh√¥ng
            setTimeout(findPossibleMoves, 500);
        }

        // X·ª≠ l√Ω s·ª± ki·ªán click v√†o √¥
        function cellClick(row, col) {
            if (isSwapping || moves <= 0) return;
            
            const cell = getCellElement(row, col);
            
            if (selectedCell === null) {
                // Ch·ªçn √¥ ƒë·∫ßu ti√™n
                selectedCell = {row, col};
                cell.classList.add('selected');
            } else {
                // ƒê√£ c√≥ √¥ ƒë∆∞·ª£c ch·ªçn, ki·ªÉm tra xem c√≥ th·ªÉ ho√°n ƒë·ªïi kh√¥ng
                const selectedCellElement = getCellElement(selectedCell.row, selectedCell.col);
                
                // B·ªè ch·ªçn √¥ hi·ªán t·∫°i
                selectedCellElement.classList.remove('selected');
                
                // Ki·ªÉm tra xem hai √¥ c√≥ k·ªÅ nhau kh√¥ng
                const isAdjacent = 
                    (Math.abs(selectedCell.row - row) === 1 && selectedCell.col === col) ||
                    (Math.abs(selectedCell.col - col) === 1 && selectedCell.row === row);
                
                if (isAdjacent) {
                    // Th·ª≠ ho√°n ƒë·ªïi
                    swapCells(selectedCell.row, selectedCell.col, row, col);
                } else {
                    // N·∫øu kh√¥ng k·ªÅ nhau, ch·ªçn √¥ m·ªõi
                    selectedCell = {row, col};
                    cell.classList.add('selected');
                }
            }
        }

        // Ho√°n ƒë·ªïi hai √¥
        function swapCells(row1, col1, row2, col2) {
            isSwapping = true;
            
            // Ho√°n ƒë·ªïi gi√° tr·ªã trong m·∫£ng board
            const temp = board[row1][col1];
            board[row1][col1] = board[row2][col2];
            board[row2][col2] = temp;
            
            // C·∫≠p nh·∫≠t giao di·ªán
            const cell1 = getCellElement(row1, col1);
            const cell2 = getCellElement(row2, col2);
            
            cell1.querySelector('.animal').textContent = board[row1][col1];
            cell2.querySelector('.animal').textContent = board[row2][col2];
            
            // Ki·ªÉm tra xem c√≥ kh·ªõp n√†o ƒë∆∞·ª£c t·∫°o ra kh√¥ng
            const matches = findMatches();
            
            if (matches.length > 0) {
                // C√≥ kh·ªõp, x·ª≠ l√Ω kh·ªõp
                updateMoves(-1);
                processMatches(matches);
            } else {
                // Kh√¥ng c√≥ kh·ªõp, ho√°n ƒë·ªïi l·∫°i
                setTimeout(() => {
                    // Ho√°n ƒë·ªïi gi√° tr·ªã trong m·∫£ng board l·∫°i
                    board[row1][col1] = board[row2][col2];
                    board[row2][col2] = temp;
                    
                    // C·∫≠p nh·∫≠t giao di·ªán
                    cell1.querySelector('.animal').textContent = board[row1][col1];
                    cell2.querySelector('.animal').textContent = board[row2][col2];
                    
                    isSwapping = false;
                }, 500);
            }
            
            // ƒê·∫∑t l·∫°i √¥ ƒë√£ ch·ªçn
            selectedCell = null;
        }

        // T√¨m t·∫•t c·∫£ c√°c kh·ªõp tr√™n b·∫£ng
        function findMatches() {
            const matches = [];
            
            // Ki·ªÉm tra kh·ªõp theo h√†ng
            for (let row = 0; row < boardSize; row++) {
                for (let col = 0; col < boardSize - 2; col++) {
                    const animal = board[row][col];
                    if (animal === board[row][col+1] && animal === board[row][col+2]) {
                        // T√¨m th·∫•y kh·ªõp 3 con v·∫≠t theo h√†ng
                        let matchLength = 3;
                        while (col + matchLength < boardSize && board[row][col+matchLength] === animal) {
                            matchLength++;
                        }
                        
                        const match = {
                            type: 'row',
                            row: row,
                            col: col,
                            length: matchLength,
                            animal: animal
                        };
                        
                        matches.push(match);
                        col += matchLength - 1; // B·ªè qua c√°c √¥ ƒë√£ ki·ªÉm tra
                    }
                }
            }
            
            // Ki·ªÉm tra kh·ªõp theo c·ªôt
            for (let col = 0; col < boardSize; col++) {
                for (let row = 0; row < boardSize - 2; row++) {
                    const animal = board[row][col];
                    if (animal === board[row+1][col] && animal === board[row+2][col]) {
                        // T√¨m th·∫•y kh·ªõp 3 con v·∫≠t theo c·ªôt
                        let matchLength = 3;
                        while (row + matchLength < boardSize && board[row+matchLength][col] === animal) {
                            matchLength++;
                        }
                        
                        const match = {
                            type: 'column',
                            row: row,
                            col: col,
                            length: matchLength,
                            animal: animal
                        };
                        
                        matches.push(match);
                        row += matchLength - 1; // B·ªè qua c√°c √¥ ƒë√£ ki·ªÉm tra
                    }
                }
            }
            
            return matches;
        }

        // X·ª≠ l√Ω c√°c kh·ªõp
        function processMatches(matches) {
            // ƒê√°nh d·∫•u c√°c √¥ kh·ªõp
            for (const match of matches) {
                if (match.type === 'row') {
                    for (let i = 0; i < match.length; i++) {
                        const cell = getCellElement(match.row, match.col + i);
                        cell.classList.add('highlighted');
                    }
                } else if (match.type === 'column') {
                    for (let i = 0; i < match.length; i++) {
                        const cell = getCellElement(match.row + i, match.col);
                        cell.classList.add('highlighted');
                    }
                }
            }
            
            // T√≠nh ƒëi·ªÉm
            let points = 0;
            for (const match of matches) {
                points += match.length * 10;
                
                // Bonus cho kh·ªõp l·ªõn h∆°n 3
                if (match.length > 3) {
                    points += (match.length - 3) * 10;
                }
                
                // Hi·ªÉn th·ªã popup
                showPopup(`+${match.length * 10} ƒëi·ªÉm!`);
            }
            
            updateScore(points);
            
            // Sau m·ªôt kho·∫£ng th·ªùi gian, x√≥a c√°c √¥ kh·ªõp v√† l√†m r∆°i c√°c √¥ ph√≠a tr√™n
            setTimeout(() => {
                // X√≥a c√°c √¥ kh·ªõp
                for (const match of matches) {
                    if (match.type === 'row') {
                        for (let i = 0; i < match.length; i++) {
                            board[match.row][match.col + i] = null;
                        }
                    } else if (match.type === 'column') {
                        for (let i = 0; i < match.length; i++) {
                            board[match.row + i][match.col] = null;
                        }
                    }
                }
                
                // B·ªè ƒë√°nh d·∫•u
                const highlightedCells = document.querySelectorAll('.highlighted');
                highlightedCells.forEach(cell => {
                    cell.classList.remove('highlighted');
                });
                
                // L√†m r∆°i c√°c √¥ v√† ƒëi·ªÅn l·∫°i c√°c √¥ tr·ªëng
                fillEmptyCells();
            }, 500);
        }

        // ƒêi·ªÅn c√°c √¥ tr·ªëng v√† l√†m r∆°i c√°c √¥
        function fillEmptyCells() {
            // L√†m r∆°i c√°c √¥ theo c·ªôt
            for (let col = 0; col < boardSize; col++) {
                // ƒê·∫øm s·ªë √¥ tr·ªëng trong c·ªôt
                let emptyCount = 0;
                
                // Di chuy·ªÉn c√°c √¥ xu·ªëng
                for (let row = boardSize - 1; row >= 0; row--) {
                    if (board[row][col] === null) {
                        emptyCount++;
                    } else if (emptyCount > 0) {
                        // Di chuy·ªÉn √¥ xu·ªëng
                        board[row + emptyCount][col] = board[row][col];
                        board[row][col] = null;
                        
                        // C·∫≠p nh·∫≠t giao di·ªán
                        const targetCell = getCellElement(row + emptyCount, col);
                        targetCell.querySelector('.animal').textContent = board[row + emptyCount][col];
                    }
                }
                
                // ƒêi·ªÅn c√°c √¥ tr·ªëng ·ªü ƒë·∫ßu c·ªôt
                for (let row = 0; row < emptyCount; row++) {
                    const animal = animals[Math.floor(Math.random() * animals.length)];
                    board[row][col] = animal;
                    
                    // C·∫≠p nh·∫≠t giao di·ªán
                    const cell = getCellElement(row, col);
                    cell.querySelector('.animal').textContent = animal;
                }
            }
            
            // Ch·ªù m·ªôt ch√∫t ƒë·ªÉ ho√†n th√†nh hi·ªáu ·ª©ng r∆°i
            setTimeout(() => {
                // Ki·ªÉm tra xem c√≥ kh·ªõp m·ªõi kh√¥ng
                const newMatches = findMatches();
                if (newMatches.length > 0) {
                    processMatches(newMatches);
                } else {
                    isSwapping = false;
                    
                    // Ki·ªÉm tra ƒëi·ªÅu ki·ªán th·∫Øng
                    checkWinCondition();
                    
                    // Ki·ªÉm tra xem c√≤n n∆∞·ªõc ƒëi h·ª£p l·ªá kh√¥ng
                    findPossibleMoves();
                }
            }, 500);
        }

        // Ki·ªÉm tra ƒëi·ªÅu ki·ªán th·∫Øng
        function checkWinCondition() {
            if (score >= target) {
                // Hi·ªÉn th·ªã th√¥ng b√°o th·∫Øng
                document.getElementById('final-score').textContent = score;
                document.getElementById('level-complete').style.display = 'flex';
            } else if (moves <= 0) {
                // H·∫øt l∆∞·ª£t, ki·ªÉm tra xem c√≥ ƒë·∫°t m·ª•c ti√™u kh√¥ng
                if (score >= target) {
                    document.getElementById('final-score').textContent = score;
                    document.getElementById('level-complete').style.display = 'flex';
                } else {
                    // Thua cu·ªôc
                    const message = document.getElementById('message');
                    message.style.display = 'block';
                    message.textContent = 'B·∫°n ƒë√£ h·∫øt l∆∞·ª£t ƒëi! H√£y th·ª≠ l·∫°i!';
                }
            }
        }

        // T√¨m c√°c n∆∞·ªõc ƒëi c√≥ th·ªÉ
        function findPossibleMoves() {
            const possibleMoves = [];
            
            // Ki·ªÉm tra c√°c ho√°n ƒë·ªïi theo h√†ng
            for (let row = 0; row < boardSize; row++) {
                for (let col = 0; col < boardSize - 1; col++) {
                    // Ho√°n ƒë·ªïi t·∫°m th·ªùi
                    const temp = board[row][col];
                    board[row][col] = board[row][col + 1];
                    board[row][col + 1] = temp;
                    
                    // Ki·ªÉm tra xem c√≥ kh·ªõp n√†o ƒë∆∞·ª£c t·∫°o ra kh√¥ng
                    const matches = findMatches();
                    if (matches.length > 0) {
                        possibleMoves.push({row1: row, col1: col, row2: row, col2: col + 1});
                    }
                    
                    // Ho√°n ƒë·ªïi l·∫°i
                    board[row][col + 1] = board[row][col];
                    board[row][col] = temp;
                }
            }
            
            // Ki·ªÉm tra c√°c ho√°n ƒë·ªïi theo c·ªôt
            for (let col = 0; col < boardSize; col++) {
                for (let row = 0; row < boardSize - 1; row++) {
                    // Ho√°n ƒë·ªïi t·∫°m th·ªùi
                    const temp = board[row][col];
                    board[row][col] = board[row + 1][col];
                    board[row + 1][col] = temp;
                    
                    // Ki·ªÉm tra xem c√≥ kh·ªõp n√†o ƒë∆∞·ª£c t·∫°o ra kh√¥ng
                    const matches = findMatches();
                    if (matches.length > 0) {
                        possibleMoves.push({row1: row, col1: col, row2: row + 1, col2: col});
                    }
                    
                    // Ho√°n ƒë·ªïi l·∫°i
                    board[row + 1][col] = board[row][col];
                    board[row][col] = temp;
                }
            }
            
            if (possibleMoves.length === 0 && moves > 0) {
                // Kh√¥ng c√≥ n∆∞·ªõc ƒëi n√†o, x√°o tr·ªôn b·∫£ng
                const message = document.getElementById('message');
                message.style.display = 'block';
                message.textContent = 'Kh√¥ng c√≤n n∆∞·ªõc ƒëi h·ª£p l·ªá! ƒêang x√°o tr·ªôn b·∫£ng...';
                
                setTimeout(() => {
                    shuffleBoard();
                    message.style.display = 'none';
                }, 1500);
            }
            
            return possibleMoves;
        }

        // X√°o tr·ªôn b·∫£ng
        function shuffleBoard() {
            // T·∫°o m·∫£ng t·∫°m th·ªùi ch·ª©a t·∫•t c·∫£ c√°c con v·∫≠t tr√™n b·∫£ng
            const allAnimals = [];
            for (let row = 0; row < boardSize; row++) {
                for (let col = 0; col < boardSize; col++) {
                    allAnimals.push(board[row][col]);
                }
            }
            
            // X√°o tr·ªôn m·∫£ng
            for (let i = allAnimals.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allAnimals[i], allAnimals[j]] = [allAnimals[j], allAnimals[i]];
            }
            
            // ƒê·∫∑t l·∫°i v√†o b·∫£ng
            let index = 0;
            for (let row = 0; row < boardSize; row++) {
                for (let col = 0; col < boardSize; col++) {
                    board[row][col] = allAnimals[index++];
                    const cell = getCellElement(row, col);
                    cell.querySelector('.animal').textContent = board[row][col];
                }
            }
            
            // Ki·ªÉm tra xem c√≥ kh·ªõp n√†o ƒë∆∞·ª£c t·∫°o ra kh√¥ng
            const matches = findMatches();
            if (matches.length > 0) {
                processMatches(matches);
            } else {
                // Ki·ªÉm tra xem c√≥ n∆∞·ªõc ƒëi h·ª£p l·ªá kh√¥ng
                findPossibleMoves();
            }
        }

        // L·∫•y ph·∫ßn t·ª≠ HTML c·ªßa √¥
        function getCellElement(row, col) {
            return document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
        }

        // C·∫≠p nh·∫≠t ƒëi·ªÉm s·ªë
        function updateScore(points = 0) {
            score += points;
            document.getElementById('score').textContent = score;
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£t ƒëi
        function updateMoves(delta = 0) {
            moves += delta;
            document.getElementById('moves').textContent = moves;
        }

        // C·∫≠p nh·∫≠t m·ª•c ti√™u
        function updateTarget() {
            target = 500 * level;
            document.getElementById('target').textContent = target;
        }

        // C·∫≠p nh·∫≠t th√¥ng tin b·∫£o v·ªá ƒë·ªông v·∫≠t
        function updateAnimalFact() {
            const factIndex = Math.floor(Math.random() * animalFacts.length);
            document.getElementById('animal-fact').textContent = animalFacts[factIndex];
        }

        // Ch∆°i l·∫°i tr√≤ ch∆°i
        function restartGame() {
            score = 0;
            moves = 20;
            selectedCell = null;
            isSwapping = false;
            
            // ·∫®n th√¥ng b√°o
            document.getElementById('message').style.display = 'none';
            document.getElementById('level-complete').style.display = 'none';
            
            // T·∫°o l·∫°i b·∫£ng
            createBoard();
            updateScore();
            updateMoves();
            updateAnimalFact();
        }

        // C·∫•p ƒë·ªô ti·∫øp theo
        function nextLevel() {
            level++;
            score = 0;
            moves = 20 + level * 2;
            selectedCell = null;
            isSwapping = false;
            
            // ·∫®n th√¥ng b√°o
            document.getElementById('level-complete').style.display = 'none';
            
            // C·∫≠p nh·∫≠t giao di·ªán
            updateTarget();
            updateScore();
            updateMoves();
            updateAnimalFact();
            
            // T·∫°o l·∫°i b·∫£ng
            createBoard();
        }

        // Hi·ªÉn th·ªã popup
        function showPopup(text) {
            const popup = document.getElementById('popup');
            popup.textContent = text;
            popup.style.opacity = 1;
            
            setTimeout(() => {
                popup.style.opacity = 0;
            }, 1000);
        }

        // Kh·ªüi t·∫°o tr√≤ ch∆°i khi trang ƒë∆∞·ª£c t·∫£i
        window.addEventListener('load', initGame);
    </script>
</body>
</html>